namespace = ctpname

ctpname.001 = {
    type = character_event
	hidden = yes
    immediate = {
        save_scope_as = ctp_holder
        IF = {
            limit = {
                OR = {
                    vassal_contract_has_flag = has_palatinate_contract
                    AND = {
                        NOT = {
                            highest_held_title_tier > tier_duchy
                        }
                        exists = primary_spouse
                        primary_spouse = {
                            vassal_contract_has_flag = has_palatinate_contract
                        }
                    }
                }
            }
            IF = {
                limit = {
                    exists = dynasty_house
                }
                dynasty_house = {
                    add_to_variable_list = { name = house_palatine target = scope:ctp_holder }
                }
            }
            else = {
                add_to_global_variable_list = { name = global_palatine target = scope:ctp_holder }
            }
        }
        else_if = {
            limit = {
                OR = {
                    vassal_contract_has_flag = has_march_contract
                    AND = {
                        NOT = {
                            highest_held_title_tier >= tier_duchy
                        }
                        exists = primary_spouse
                        primary_spouse = {
                            vassal_contract_has_flag = has_march_contract
                        }
                    }
                }
            }
            IF = {
                limit = {
                    exists = dynasty_house
                }
                dynasty_house = {
                    add_to_variable_list = { name = house_marquess target = scope:ctp_holder }
                }
            }
            else = {
                add_to_global_variable_list = { name = global_marquess target = scope:ctp_holder }
            }
        }
    }
}
ctpname.002 = {
	type = none
	hidden = yes
	trigger = {
		always = yes
	}
    immediate = {
		add_to_global_variable_list  = { name = laqab_elder_missionary target = character:45108 }
		add_to_global_variable_list  = { name = laqab_younger_missionary target = character:163166 }
		character:45108 = {
			add_character_flag = laqab_assigned
			remove_nickname = yes
		}
		character:163166 = {
			add_character_flag = laqab_assigned
		}
	}
}